<!-- Header -->
<app-header></app-header>

<div class="container">
  
  <div class="cart-container">

    <!-- Pasos -->
    <div class="cart-header">
      <div class="cart-step active">Mi Carrito</div>
      <div class="cart-step">Delivery</div>
      <div class="cart-step">Pago</div>
      <div class="cart-step">Confirmación</div>
    </div>

    <!-- Tabla de productos -->
    <div class="cart-table">
      <div class="cart-row header">
        <div>Producto</div>
        <div>Precio</div>
        <div>Cantidad</div>
        <div>Precio Total</div>
      </div>

      <div class="cart-row" *ngFor="let producto of carrito">
        <div class="product-info">
          <img [src]="imagenUrl(producto)" [alt]="producto.nombre" style="width: 80px; height: 80px; object-fit: cover;" />
          <div>
            <h3>{{ producto.nombre }}</h3>
            <p>{{ producto.subcategoria }}</p>
          </div>
        </div>

        <div class="price">S/.{{ producto.precio.toFixed(2) }}</div>

      <div class="quantity">
          <button (click)="disminuirCantidad(producto)" [disabled]="producto.cantidad <= 1">-</button>
          <span>{{ producto.cantidad }}</span>
          <button (click)="aumentarCantidad(producto)" [disabled]="producto.cantidad >= producto.stock">+</button>
      </div>

        <div class="total-price">S/.{{ (producto.precio * producto.cantidad).toFixed(2) }}</div>

        <div class="actions">
          <button (click)="eliminarProducto(producto)" class="btn_host">Eliminar</button>
        </div>
      </div>
    </div>

    <!-- Resumen -->
    <div class="cart-summary">
      <div class="summary-box">
        <h3>Envío</h3>
        <select>
          <option>País</option>
        </select>
        <div class="city-zip">
          <select><option>Ciudad</option></select>
          <input type="text" placeholder="Código ZIP" />
        </div>
        <button>Actualizar</button>
      </div>

      <div class="summary-box">
        <h3>Código de cupón</h3>
        <p>Ingresa tu cupón para descuento en el carrito.</p>
        <input type="text" placeholder="Código promocional" [(ngModel)]="codigoCupon" />
        <button (click)="aplicarCupon()">Aplicar</button>
      </div>

      <div class="summary-box total">
        <h3>Total del carrito</h3>
        <p>Subtotal: <span>S/.{{ subtotal.toFixed(2) }}</span></p>
        <p>Envío: <span class="free">Free</span></p>
        <p>Descuento: <span class="discount">-S/.{{ descuento.toFixed(2) }}</span></p>
        <p class="final">Total: <span>S/.{{ total.toFixed(2) }}</span></p>
        <button>Verificar</button>
      </div>
    </div>

    <!-- Botón siguiente -->
    <div class="next-step" style="text-align: right; margin-top: 1rem;">
      <button class="btnprimary_" routerLink="/delivery">Siguiente</button>
    </div>
  </div>
</div>
<!-- Footer -->
<app-footer></app-footer>
