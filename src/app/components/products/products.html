<app-header></app-header>

<main>
  <div class="container">

    <!-- 游리 Sidebar de filtros -->
    <aside class="filters">
      <h3>Filtrar productos</h3>

      <!-- 游댳 Filtro por categor칤a -->
      <section class="filtro-categorias">
        <h4>Categor칤as</h4>
        <label *ngFor="let cat of categorias">
          <input type="radio" name="cat" [value]="cat" [(ngModel)]="filtroCategoria" (change)="actualizarSubcategorias()" />
          {{ cat }}
        </label>
      </section>

      <!-- 游댳 Filtro por subcategor칤a -->
      <section class="filtro-subcat" *ngIf="subcategorias.length > 0">
        <h4>Subcategor칤as</h4>
        <label *ngFor="let sub of subcategorias">
          <input type="radio" name="subcat" [value]="sub" [(ngModel)]="filtroSubcategoria" />
          {{ sub }}
        </label>
      </section>

      <!-- 游댳 Filtro por estado -->
      <section class="filtro-estado">
        <h4>Estado del producto</h4>
        <div class="estado-buttons">
          <button class="pill on-sale" 
                  [ngClass]="{'active': filtroEstado==='En Oferta'}" 
                  (click)="filtroEstado='En Oferta';">
            En Oferta
          </button>
          <button class="pill available" 
                  [ngClass]="{'active': filtroEstado==='Disponible'}" 
                  (click)="filtroEstado='Disponible';">
            Disponible
          </button>
          <button class="pill out" 
                  [ngClass]="{'active': filtroEstado==='Agotado'}" 
                  (click)="filtroEstado='Agotado';">
            Agotado
          </button>
        </div>
      </section>

      <!-- 游댳 Botones de filtros -->
      <div class="filter-actions">
        <button class="btnprimary_" (click)="aplicarFiltros()">Aplicar filtros</button>
        <button class="btnprimary_" (click)="limpiarFiltros()">Limpiar filtros</button>
      </div>
    </aside>

    <!-- 游릭 츼rea de productos -->
    <section class="grid-area">

      <!-- Controles superiores -->
      <div class="top-controls">
        <div class="count">{{ productosFiltrados.length }} Productos</div>
        <div class="sort">
          Ordenar por
          <select [(ngModel)]="orden">
            <option value="mayor">Precio: Mayor a menor</option>
            <option value="menor">Precio: Menor a mayor</option>
            <option value="nuevo">M치s nuevos</option>
          </select>
        </div>
      </div>

      <!-- Grid de productos -->
      <div class="cards">
        <article class="card" *ngFor="let producto of productosPagina()">
          <figure class="thumb" (click)="verDetalle(producto)" style="cursor: pointer;">
          <img [src]="'http://localhost:3000/uploads/productos/' + producto.imagen" [alt]="producto.nombre" />
        </figure>

          <div class="card-body">
            <h3 class="title">{{ producto.nombre }}</h3>
            <p class="desc">{{ producto.descripcion }}</p>
            <div class="price">S/ <strong>{{ producto.precio }}</strong></div>
            <div class="stock">Stock: {{ producto.stock }} unidades</div>
            <div class="actions">
              <!-- <button class="btn primary">Comprar ahora</button> -->
              <button class="btn ghost" (click)="agregarAlCarrito(producto)">A침adir al carrito</button>
            </div>
          </div>
        </article>
      </div>

      <!-- Paginaci칩n -->
      <nav class="pagination">
        <button (click)="cambiarPagina(paginaActual - 1)" [disabled]="paginaActual === 1">&lt;</button>
        <button *ngFor="let p of paginas()" (click)="cambiarPagina(p)" [class.active]="p === paginaActual">{{ p }}</button>
        <button (click)="cambiarPagina(paginas().length)" [disabled]="paginaActual === paginas().length">&gt;</button>
      </nav>
    </section>

  </div>
</main>

<app-footer></app-footer>
